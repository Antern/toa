domain: teapots

state:
  name: teapots
  schema:
    properties:
      name:
        type: string
      volume:
        type: number
      material:
        type: string
        enum: [ glass, metal ]
      price: number
      markup: number
    required: [ name, volume ]
  max:
    limit: 100
    omit: 1000

operations:
  add:
    template: ~
    http: /
  update:
    template: ~
    schema:
      properties:
        name: ~
    http: /{_id}
  list:
    template: find
    query:
      limit: 10
      sort: name:asc
      projection: [ name, volume, material ]
      sealed: 1
    http:
      - /
      - path: /metal
        query:
          criteria: ;name==test
          limit: 5
          sealed: 0
        representation: [ name ]
      - path: /filter/{*name}
        query:
          criteria: name!=*name
          limit: 5
          frozen: 1
      - path: /messages/{room}/{*perspective}
        query:
          criteria: (sender==*perspective;sent==1),(recipient==*perspective;received==1)
        authorization:
          schema: basic
          rules:
            allow:
              - user: perspective
  get:
    template:
      package: '@kookaburra/templates'
      name: get
    http: /{_id}
  boil:
    schema:
      properties:
        interval: number
