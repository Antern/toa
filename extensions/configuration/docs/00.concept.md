# Concept

## Definitions

Distributed System Configuration (**Configuration**) is a set of static[^1] parameters for all algorithms within a given
system.

**Context Configuration** is a set of values that overrides default values for configuration of components added to a
given context.

**Component Configuration** is a subset of Configuration for algorithms within a component.

## Responsibility segregation

Component Configuration is a schema defining the *form* of configuration. Specific *values* for this schema are
defined by Context Configuration.

## Component Configuration

Component Configuration is declared as a component extension using JSONSchema `object` type.

> Yet there is no way to provide configuration values without a deployment, it is recommended to have default values
> for all required parameters to be able to run operations locally.
>
> [#130](https://github.com/toa-io/toa/issues/130)

### Example

> Well-known shortcut `configuration` is available both for component and context manifests.

```yaml
# component.toa.yaml
domain: dummies
name: dummy

configuration:
  properties:
    foo:
      type: string
      default: 'baz'
    bar:
      type: number
  required: [foo]
```

## Context Configuration

Context Configuration is declared as a context extension. Configuration keys may
be defined with [deployment environment discriminators](#).

### Example

```yaml
# context.toa.yaml
configuration:
  dummies.dummy:
    foo: quu
    bar: 1
    bar@staging: 2
```

## Secrets

Context Configuration values which are uppercase strings prefixed with `$` considered as Secrets.

### Example

```yaml
# context.toa.yaml
configuration:
  payments.gateway:
    api-key: $STRIPE_API_KEY
```

### Secrets Deployment

Secrets are not being deployed with context deployment ([`toa deploy`](#)), thus must be deployed separately once for
each deployment environment manually ([`toa conceal`](#)).

[^1]: That is canâ€™t be changed without a deployment. This is because new values considered to be a subject of
testing. [#146](https://github.com/toa-io/toa/issues/146)
