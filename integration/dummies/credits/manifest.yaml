domain: credits
name: balance

entity:
  schema:
    properties:
      balance:
        type: integer
        default: 10
  initialized: true

operations:
  transit:
    input:
      properties:
        balance: ~
  deduce:
    input: integer
    output: integer
    query: true
  debit:
    forward: deduce
    concurrency: retry
  transfer:
    input: id   # source balance
    query: true # target balance
  nullify:
    output: integer

extensions:
  resources:
    /:id:
      operations: [observe]
